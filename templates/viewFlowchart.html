{% extends "bootstrap/base.html" %}
{% include 'layout.html' %}
{% block scripts %}
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.10.1/lodash.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.3.3/backbone.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jointjs/2.1.0/joint.js"></script>
        <script src="http://d3js.org/d3.v3.min.js"></script>
        <script type="text/javascript">
        var flowchart_courses = {{ flowchart_courses|tojson }}
        var prerequisite_links = {{ prerequisite_links|tojson }}
        var student_results = {{ student_results|tojson }}

       $(document).ready(function(e){
            $('#editGradeFlowchartForm').on('submit',function(){
                //alert( $('#inputGradeFlowchart').val() );
                location.reload();
            });

            $('#infoFlowchartForm').on('submit',function(){
                //alert( $('#inputGradeFlowchart').val() );
                //location.reload();
            });
        });


        function validateGrade() {
            console.log('validategrade');

            // retrieve grade input
            var getGrade = $('input#inputGradeFlowchart').val();

            var valid = true;
            $('p#editGradeError').text('');

            // if there is only one char that char must be a letter
            var letters = ['A', 'B', 'C', 'D', 'F', 'T'];

            //
            var special_chars = ['-','+'];

            if (getGrade.length == 0) {
                console.log('you must enter grade');
                $('p#editGradeError').text('Please enter a grade');
                valid = false;
            }

            {#else if (getGrade.length == 1) {

                for (var l = 0; l < letters.length; l++) {
                    if (getGrade != letters[l]) {
                        $('p#editGradeError').text('Invalid value');
                        valid = false;
                    }
                }
                //console.log(getGrade[0]);
            }

            else if (getGrade.length == 2) {
                for (var l = 0; l < letters.length; l++) {
                    for (var s = 0; s < special_chars; s++) {
                        if (getGrade[0] != letters[l]) {
                            $('p#editGradeError').text('Invalid value');
                            valid = false;
                        }
                        else if (getGrade[1] != special_chars[s]) {
                            $('p#editGradeError').text('Invalid value');
                            valid = false;
                        }
                    }
                }
                //console.log(getGrade[1]);
            }#}

            else if (getGrade.length > 2) {
                console.log('too many chars');
                $('p#editGradeError').text('Invalid value');
                valid = false;
            }

            console.log(getGrade);
            return valid;
        }

        </script>
        <script src="/static/flowchart.js"></script>
        {{super()}}
    <style>
        div.modal-content, div.modal-footer, input.btn
        {
            z-index: 9900000 !important;
        }
    </style>
    {% endblock %}
{% block head %}
    <link rel="stylesheet" type="text/css" href="{{url_for('.static', filename='accm.css')}}">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/jointjs/2.1.0/joint.css">
    <script  src="https://code.jquery.com/jquery-3.4.1.slim.min.js"  integrity="sha256-pasqAKBDmFT4eHoN2ndd6lN370kFiGUFyTiUHWhU7k8="  crossorigin="anonymous"></script>
    <script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.7/jquery.validate.min.js"></script>

    {{ super() }}

    <script type=text/javascript>

    $( document ).ready(function() {
        $(".hBack").on("click", function(e){
            e.preventDefault();
            window.history.back();
        });

    });
    function goBack() {
        e.preventDefault();
      history.back()
    }

    </script>


    <style>

    </style>

{% endblock %}

{% block content %}
     <h1>Student Program Progress</h1>
    <h2>{{ studentName }} : {{ studentNum }} </h2>
    <form>
	{% if bBackKey %}
    <button class="btn btn-secondary hBack" type="button"><i class="fas fa-chevron-left"></i></button>
	{% endif %}
    </form>

    <!-- Info Modal -->
    <div class="modal fade" id="infoFlowchart" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLongTitle">Course Info</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>

            <form id="infoFlowchartForm" action="{{ url_for('viewFlowchart', sid= sid ) }}" method="POST" class="needs-validation" >
          <div class="modal-body">

              <div class="form-group row">
                <label for="infocourseCode" class="col-sm-3 col-form-label">Course Code</label>
                <div class="col-sm-9">
                  <input type="text" readonly class="form-control-plaintext" id="infocourseCode" value="">
                </div>
              </div>

              <div class="form-group row">
                <label for="infocourseTitle" class="col-sm-3 col-form-label">Course Title</label>
                <div class="col-sm-9">
                  <input type="text" readonly class="form-control-plaintext" id="infocourseTitle" value="">
                </div>
              </div>


          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>

          </div>
            </form>
        </div>
      </div>
    </div>


    <!-- Edit Modal -->
    <div class="modal fade" id="editGradeFlowchart" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLongTitle">Edit Grade</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>

            <form id="editGradeFlowchartForm" action="{{ url_for('viewFlowchart', sid= sid ) }}" method="POST" class="needs-validation" onsubmit="return validateGrade()">
          <div class="modal-body">

              <div class="form-group row">
                <label for="courseCode" class="col-sm-3 col-form-label">Course Code</label>
                <div class="col-sm-9">
                  <input type="text" readonly class="form-control-plaintext" id="courseCode" value="">
                </div>
              </div>

              <div class="form-group row">
                <label for="courseTitle" class="col-sm-3 col-form-label">Course Title</label>
                <div class="col-sm-9">
                  <input type="text" readonly class="form-control-plaintext" id="courseTitle" value="">
                </div>
              </div>

              <div class="form-group row">
                <label for="inputGradeFlowchart" class="col-sm-3 col-form-label">Grade</label>
                <div class="col-sm-9">
                  <input type="text" class="form-control" id="inputGradeFlowchart" name="inputGradeFlowchart" value="">
                    <p class="error" id="editGradeError"></p>
                    <input type="hidden" class="form-control" name="gradeID" id="gradeID" value="" >
                    <input type="hidden" class="form-control" name="mapid" id="mapid" value="" >
                </div>
              </div>

          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            <input type="submit" class="btn btn-success" value="Save Grade">
          </div>
            </form>
        </div>
      </div>
    </div>

 <div class="container"  id="flowchart">
 </div>

<footer class="container ">
  <p class="float-right">Â© Algonquin College 2019-2020</p>
</footer>


{% endblock %}






